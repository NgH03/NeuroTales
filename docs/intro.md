# 项目简介
### 1. 团队和项目背景介绍

#### 1.1 团队进展

过去的3年，我们团队专注于脑机接口应用的研究，目前在实时专注力识别和训练方面有一定的进展。主要包括以下成果：

- BCI-GAME：A lightweight, read-time BCI system

  ![image-20250705114937726](assets\image-20250705114937726.png)

- NeuroDashV1.0：A BCI-parkour game for engagement training

  ![image-20250705120253941](assets\image-20250705120253941.png)

#### 1.2 基于脑机接口的脑状态识别、训练

以下研究显示，基于脑机接口的脑状态识别、训练在教育应用领域有巨大潜能

- 王朋利等（2020）利用脑机接口搭建中小学生注意力识别模型，平均正确率为75.8%，研究者据此设计教学内容和实施教学策略，学生学习效果提升显著[^1]。
- 脑机接口对自控能力的培养优势明显、效果显著，融合娱乐元素的脑控产品训练大脑专注力，可培养学生自控能力[^2]。
- 卡托纳等（Katona et al.，2016）利用脑机接口技术开发了平均注意力测 量系统，对改善上课期间学生的学习状态有较大帮助[^3]。
- 胡航等（2019）借助意念耳机设备（MindSet）， 设计和开发了一套针对英语听力的学习系统，即利用脑电信号估测学生专注度值，监测和调节学生注意力变化。对某大学100名大一新生持续1个月的实验研究发现，其对学生的学业成绩、学习态度和自我效能感等有显著改善[^4]。

但是我们发现，脑状态识别、训练领域当前存在以下问题：

- **用户不友好：**使用者非脑科学相关背景，无法理解专业的脑电数据，进而难以评估自己的大脑状态，无从改善
- **研究门槛高**：BCI系统的搭建困难，信号采集、信号分析、目标特征提取、评估模型搭建等步骤繁多，开发者难以验证想法和理论
- **通用性差**：不同年龄、性别的受试者，以及不同的使用场景，都需要不同的识别评估方式和训练方式，受此局限目前无通用的解决方案，用户覆盖面少

#### 1.3 解决方案

近年来，AI的进展飞速，其强大的能力正在颠覆各个行业。我们认为脑状态识别、训练领域引入大模型，可以有效在技术上解决上述问题，并且随着大模型技术地不断发展，未来有望在脑机交互、内容反馈等取得突破。

综上，我们将AI大模型引入大脑专注状态的识别，开发了NeuroTales ：AI脑状态评估系统。

### 2. Introduction of NeuroTales —— 吴昊

#### 2.1 系统概述

NeuroTales是一个轻量级、分布式的，使用LLM评估大脑状态的系统。

![image-20250706160007132](assets\image-20250706160007132.png)

#### 2.2 系统组成

- **预处理模块：**预处理模块可用于处理实时/已录制的EEG数据，使用目前已有的成熟的脑电信号处理技术和框架（Timeflux、OpenBCI等）将EEG数据转换成需要评估的脑状态特征，作为参数拼接到prompt。
- **数据存储模块：**数据的存储的
    - **数据集存储：**将实时、已录制的EEG源数据集/经过分析的信号图像等文件通过S3（对象存储）进行存储，将数据与处理进行解耦。
    - **知识存储：**将评估生成所需要的脑科学等理论作为知识库，知识库经过向量模型向量化后存储在向量数据库，用于检索生成增强（RAG）提升评估表现。
    - **记忆存储：**以用户自定义粒度存储已生成的prompt和脑状态评估报告，用于LLM提供更加个性化、有变化性的评估报告。
- **评估生成模块：**
    - **prompt：**将预处理的特征值参数、用户数据、使用场景和环境、评估要求等拼接成资源语言prompt，输入到generator。
    - **RAG：**在向量数据库中检索与问题相关的信息，然后将这些检索到的信息与prompt一起输入到生成模型中，辅助生成更准确的评估报告。
    - **Generator：**使用AI大语言模型生成脑状态评估报告。

#### 2.3 系统特点

Neurotales提供了一种通用性的解决方案，采用分布式架构将数据和处理解耦，具有高可用性和拓展性。针对不同的评估需求，如专注力、情绪、放松度等，不需要重复建立评估体系，仅需在预处理模块添加对应处理器和数据模型，以及知识库中添加知识文档，AI大模型具有通用的解决能力。

目前的V1.0版本支持Web端上传脑电数据，服务端进行预处理后，将数据输入至AI大语言模型，由大模型返回专注力评估报告。

### 3. LLM and LEM

#### 3.1 文本大模型与脑电大模型

目前的多模态大模型，如图像、声音等信号在大模型领域有很成熟的应用，但脑电信号却缺乏成熟的脑电大模型。将大脑动态翻译成自然语言对于BCI至关重要，弥合大脑与语言之间差距的需求变得日益迫切。

| **类别**       | **模型**        | **参数量** |
| :------------- | :-------------- | :--------- |
| **文本大模型** | GPT-4o          | ~1.8T      |
| **脑电大模型** | LaBraM-Huge[^5] | 369M       |

然而，与文本数据相比，通常脑电数据集的规模非常小，格式也千差万别。开发大型脑电模型面临着下列几方面的挑战：缺乏足够的脑电数据、EEG信号采集的多样化配置、缺乏有效的脑电表征学习范式。

目前，虽然脑电大模型在一些脑电信号的处理能过达到医疗级水准，但是难以满足内容生成的需求，尤其是与用户进行自然语言交互的能力，这一点在脑状态识别和训练中是不可或缺的。因此Neurotales系统的Generator使用LLM。

#### 3.2 RAG

目前市面上较为成熟的大模型能够理解文本、图像、代码、数学语言甚至是视频，但是对脑电信号这个模态并能没有很好的支持。如果将脑电数据输入文本大模型，大模型在生成回答往往有3大问题：容易出现幻觉、缺乏专业知识、回答缺乏可解释性。

为了解决这些问题，我们引入RAG技术。RAG 是一种**将信息检索（IR）与大型语言模型（LLM）生成能力相结合**的技术。

![image-20250707135014585](assets\image-20250707135014585.png)



#### 3.3 文本大模型应用于BCI

为了在脑电领域应用大模型的能力，我们使用了“特征值+RAG+prompt”的技术方案。

![image-20250706194744094](assets\image-20250706194744094.png)

该方案完全符合主流大语言模型的交互方式，是一种将大语言模型的能力应用到垂直领域的技术方案。

### 4. 系统的表现

#### 4.1 信号分析模块

我们使用OpenBCI官方提供的一段“冥想”状态下采集的数据，截取90秒时长的数据，使用OpenBCI_GUI官方工具进行数据处理和分析，我们可以达到一份官方的二值化专注力参数

![focus](assets\focus.png)

在Neurotales系统下对这段数据进行分析。在预处理模块基于Timeflux，根据
$$
EI = β/(α+θ)
$$
公式计算Engagement Index，我们得到这样一份专注力特征参数，作图如下：

![ei](assets\ei.png)

可以看出基本符合官方实际的专注力趋势，并且较二值化参数具有更加细节的特征。

#### 4.2 评估生成模块

将特征值拼接到以下基本prompt

```
用户信息：
- 年龄：21
- 性别：男
- 行为：短时间冥想

专注力数据分析：
- 专注力数值（每秒记录一次，由脑电中的 β/(α+θ) 计算得来）：{{ei_values}}

上述是受试者的信息和实验时间内用户的行为，现在根据你的分析结果生成报告，生成的报告应该是第二人称视角的，应包含以下部分：
1. 专注力状态分类（走神/一般/专注）及各状态持续时间：[按数据分类并计算时间]，专注力变化趋势：[描述趋势]
2. 结果总览：总结专注力和放松能力的得分及简要描述。
3. 推荐解决方案：根据测评结果提供个性化的训练建议。

报告风格应专业、清晰，紧密结合用户信息和实验场景，也就是整个是对用户在他的实验场景下的专注力表现的评估，liu'cheng、图标等方式让你的报告易于理解，并包含数据说明和改进建议。
```

并且知识库中包含一篇解释β/(α+θ)公式含义的知识文档用于RAG。使用***qwen-max-2025-01-25***大模型生成评估报告如下

![report](assets\report.png)

由此可见，AI大模型的评估与官方二值化信号的描述十分相似，提供了更加细致、实际、结合场景的专注力评估，并提出了提升建议。

综上，Neurotales系统基本能实现一种通用的解决方案，使得脑电领域的脑状态评估的门槛大大降低，同时用户理解的成本也大大降低。

### 5. 总结

#### 5.1 Neurotales的应用

Neurotales在实现用户友好的专注力评估的基础上，可以用于以下应用：

- **专注力训练：**例如将番茄工作法结合Neurotales，对比每25分钟的专注力表现，引导用户改善学习、工作状态，调控专注力。
- **线上课堂内容生成：**
    - **背景：**越来越多学生通过视频课学习，但是线上课堂不具备传统课堂的交互性，视频课也不会像学校老师监督学生的状态，调整讲课的节奏和难度。
    - **解决方案：**学生佩戴脑机接口结合Neurotales，AI视频课实时监测学生的专注状态，调整视频课内容的节奏和难度，实时生成新的教学内容，实现个性化AI一对一线上课堂。

#### 5.2 Neurotales可提升的部分

- **预处理：**未来Neurotales将引入专注力之外的情绪、放松度等其他状态，提供更加丰富的功能。
- **提示词：**未来Neurotales将探索如何让大模型更好地理解脑电特征，生成更加准确地报告。

[^1]:  柯清超，王朋利（2019）. 脑机接口技术教育应用的研究进 展[J]. 中国电化教育， （10）：14-22.
[^2]:  Nierhaus，T.，Vidaurre，C.，Sannelli，C.，Mueller，K. R.，& Villringer，A.（2021）. Immediate brain plasticity after one hour of brain-computer interface （BCI）[J]. The Journal of Physiology，599（9）：2435-2451.
[^3]: Katona， J.， & Kovari，A.（2016）. A brain-computer interface project applied in computer engineering[J]. IEEE Transactions on Education，59（4）：319-326.
[^4]: 胡航，李雅馨，曹一凡，赵秋华，郎启娥（2019）. 脑机交互促进学习有效发生的路径及实验研究：基于在线学习系统中的注意力干预分析[J]. 远程教育杂志，37 （4）：54-63.
[^5]: Jiang, W.B., Zhao, L.M. and Lu, B.L., 2024. Large brain model for learning generic representations with tremendous EEG data in BCI. *arXiv preprint arXiv:2405.18765*.

